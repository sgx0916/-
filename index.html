import tkinter as tk
import random

def create_tip_window(main_root):
    # 随机窗口位置（避免超出屏幕）
    screen_w = main_root.winfo_screenwidth()
    screen_h = main_root.winfo_screenheight()
    win_w, win_h = 250, 60
    x = random.randint(0, screen_w - win_w)
    y = random.randint(0, screen_h - win_h)

    # 随机提示语和背景色
    tips = [
        '多喝水哦~', '保持微笑呀', '每天都要元气满满', '记得吃水果', '保持好心情',
        '好好爱自己', '我想你了', '梦想成真', '期待下一次见面', '顺顺利利',
        '早点休息', '愿所有烦恼都消失', '别熬夜', '今天过得开心嘛', '天冷了，多穿衣服'
    ]
    bg_colors = [
        'lightpink', 'skyblue', 'lightgreen', 'lavender', 'lightyellow',
        'plum', 'coral', 'bisque', 'aquamarine', 'mistyrose', 'honeydew'
    ]

    # 创建子窗口（优化：设置窗口透明度，减少视觉压迫）
    tip_win = tk.Toplevel(main_root)
    tip_win.title('温馨提示')
    tip_win.geometry(f"{win_w}x{win_h}+{x}+{y}")
    tip_win.attributes('-topmost', True)
    tip_win.attributes('-alpha', 0.85)  # 窗口透明度85%，更柔和

    # 添加提示标签（优化：固定标签大小，避免文字溢出）
    tk.Label(
        tip_win, text=random.choice(tips),
        bg=random.choice(bg_colors),
        font=('微软雅黑', 14), width=20, height=2, wraplength=220
    ).pack(padx=5, pady=5)

    # 关键优化：缩短自动关闭时间为2秒，减少窗口同时存在数量
    tip_win.after(2000, tip_win.destroy)

def main():
    root = tk.Tk()
    root.withdraw()  # 隐藏主窗口

    # 核心优化1：延长创建间隔至0.5秒，避免资源瞬间耗尽
    total = 520
    for i in range(total):
        root.after(i * 500, create_tip_window, root)

    # 核心优化2：添加主窗口关闭时，自动销毁所有提示窗的逻辑
    def on_main_close():
        for child in root.winfo_children():
            child.destroy()
        root.destroy()
    root.protocol("WM_DELETE_WINDOW", on_main_close)

    root.mainloop()

if __name__ == "__main__":
    main()
